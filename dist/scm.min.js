/*! scm 2017-01-03 */
var SC={};SC.Store=function(a,b){"use strict";function c(a,b){var c=a[b];return c||(c=[],a[b]=c),c}function d(a){var b;for(b=0;b<a.length;b++)if(a[b].isDefault)return!0;return!1}function e(a,b){return a[b]||null}function f(b,d,e,f){var g,h,i=c(b,e),j=i.length;if(d===a.scdefault)return void(i.length=0);for(g=j-1;g>=0;g--)h=i[g],h.context===d&&h.handler===f&&i.splice(g,1),f||h.context!==d||i.splice(g,1)}function g(a,b){var c=a[b];c&&0===c.length&&delete a[b]}function h(b,c){var d,e,f,g=c===a.scdefault;for(e in b)if(b.hasOwnProperty(e)){for(f=b[e],d=f.length-1;d>=0;d--)(f[d].context===c||g)&&f.splice(d,1);0===f.length&&delete b[e]}}function i(a,b,e,f,g){var h=c(a,b[0]),i=d(h),j=new l(e,f,b[1],g);if(g){if(!i)return void h.unshift(j);throw"ShortcutManager: Can not add another default handler for shortcut "+b+"."}h.push(j)}function j(a,b,c,d){void 0!==b[0]&&null!==b[0]?f(a,c,b[0],d):h(a,c),g(a,b[0])}function k(a){var b,c,d,e,f,g,h=[];if(a&&a.match(o)){for(d=o.exec(a),g=d[1],f=d[2].split(n),e=parseInt(f[0],10),c=parseInt(f[1],10),b=e;c>=b;b++)h.push([a.replace(g,b),b]);return h}return h.push([a||null,-1]),h}function l(a,b,c,d){this.isDefault=d||!1,this.modifier=c,this.context=a,this.handler=b}function m(){this.store={}}var n="..",o=/.*\+(\[([0-9]..[0-9])\])/g;return b=m.prototype,b.save=function(a,b,c,d){var e,f=k(a);for(e=0;e<f.length;e++)i(this.store,f[e],b,c,d)},b.get=function(a){return e(this.store,a)},b.exists=function(a){return Boolean(this.store[a])},b.remove=function(a,b,c){var d,e=k(b);for(d=0;d<e.length;d++)j(this.store,e[d],a,c)},m}(SC),SC.Normalizer=function(a,b){"use strict";function c(a){return j[a]}function d(a){return a>=96&&105>=a?a-48:a}function e(a){var b=l[a];return a=d(a),b?b:String.fromCharCode(a).toLowerCase()}function f(a){return Boolean(m[a])}function g(){}function h(a){return k[a]||a}var i="+",j={ctrl:0,alt:1,shift:2},k={enter:"return"},l={8:"backspace",9:"tab",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",106:"*",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",107:"+",109:"-",187:"+",188:",",189:"-",190:".",191:"/"},m={187:"+"};return b=g.prototype,b.fromEvent=function(a){var b,c=!f(a.keyCode);return b=a.ctrlKey?"ctrl+":"",b+=a.altKey?"alt+":"",b+=a.shiftKey&&c?"shift+":"",b+=e(a.keyCode)},b.normalize=function(a){var b,d,e,f,g=[],j=[];if(void 0===a||null===a)return a;if(a===i)return i;for(e=a.toLowerCase().split(i),b=0;b<e.length;b++)f=c(e[b]),void 0!==f?g[f]=e[b]:(d=h(e[b]),j.push(d));return g=g.concat(j),g=g.filter(function(a){return a}),g.join(i)},g}(SC),SC.Manager=function(a,b){"use strict";function c(b){this.context=a.scdefault,this.isStatic=b||!1}function d(a){g&&console.debug(a)}var e=new a.Store,f=new a.Normalizer,g=!1;return a.scdefault=window,b=c.prototype,b.create=function(b){return(new a.Manager)["in"](b)},b["in"]=function(a){if(this.isStatic)throw"ShortcutManager: Can not change context on static method. Use ShortcutManager.create() with right context.";return this.context=a,this},b.on=function(a,b,c){var g=f.normalize(a);e.save(g,this.context,b,c),d("register "+a)},b.normalize=function(a){return"object"==typeof a?f.fromEvent(a):f.normalize(a)},b.remove=function(a,b){var c=f.normalize(a);e.remove(this.context,c,b),d("remove "+a)},b.event=function(a){var b,c,g,h=f.fromEvent(a);if(h)if(b=e.get(h),b&&b.length){for(d("ShortcutManager: Trying to handle '"+h+"' shortcut,","available handlers:"),g=b.length-1;g>=0;g--){if(c=b[g].handler(h,b[g].modifier))return d("ShortcutManager: Handler with index '"+g+"' handled shortcut, handler: "),d(b[g].handler),!0;d("ShortcutManager: Handler with index '"+g+"' returned false...trying next")}d("ShortcutManager: There is no more handler to try, returning false")}else d("ShortcutManager: There is no handler for '"+h+"' shortcut");return!1},b.exists=function(a){var b;return"object"==typeof a&&(a=f.fromEvent(a)),"string"==typeof a&&(a=f.normalize(a)),b=e.exists(a),d(b?"ShortcutManager: Shortcut '"+a+"' is registered":"ShortcutManager: Shortcut '"+a+"' is not registered"),b},b.destroy=function(){this.remove()},b.debugMode=function(a){g=a,console.info("ShortcutManager debug mode is set to "+(a?"on":"off"))},c}(SC);var ShortcutManager=new SC.Manager(!0);