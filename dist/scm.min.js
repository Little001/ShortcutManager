/*! scm 2016-08-18 */
var SC={};SC.Store=function(a,b){"use strict";function c(a,b){var c=a[b];return c||(c=[],a[b]=c),c}function d(a){var b;for(b=0;b<a.length;b++)if(a[b].isDefault)return!0;return!1}function e(a,b){var c=a[b];return c?c.map(function(a){return a.handler}):null}function f(b,d,e,f){var g,h,i=c(b,e),j=i.length;if(d===a.scdefault)return void(i.length=0);for(g=j-1;g>=0;g--)h=i[g],h.context===d&&h.handler===f&&i.splice(g,1),f||h.context!==d||i.splice(g,1)}function g(a,b){var c=a[b];c&&0===c.length&&delete a[b]}function h(b,c){var d,e,f,g=c===a.scdefault;for(e in b)if(b.hasOwnProperty(e)){for(f=b[e],d=f.length-1;d>=0;d--)(f[d].context===c||g)&&f.splice(d,1);0===f.length&&delete b[e]}}function i(a,b,c){this.isDefault=c||!1,this.context=a,this.handler=b}function j(){this.store={}}return b=j.prototype,b.save=function(a,b,e,f){var g=this.store,h=c(g,a),j=d(h),k=new i(b,e,f);if(f){if(!j)return void h.unshift(k);throw"ShortcutManager: Can not add another default handler for shortcut "+a+"."}h.push(k)},b.get=function(a){return e(this.store,a)},b.exists=function(a){return Boolean(this.store[a])},b.remove=function(a,b,c){var d=this.store;void 0!==b&&null!==b?f(d,a,b,c):h(d,a),g(d,b)},j}(SC),SC.Normalizer=function(a,b){"use strict";function c(a){return i[a]}function d(a){return a>=96&&105>=a?a-48:a}function e(a){var b=j[a];return a=d(a),b?b:String.fromCharCode(a).toLowerCase()}function f(a){return Boolean(k[a])}function g(){}var h="+",i={ctrl:0,alt:1,shift:2},j={8:"backspace",9:"tab",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",107:"+",109:"-",187:"+",189:"-"},k={187:"+"};return b=g.prototype,b.fromEvent=function(a){var b,c=!f(a.keyCode);return b=a.ctrlKey?"ctrl+":"",b+=a.altKey?"alt+":"",b+=a.shiftKey&&c?"shift+":"",b+=e(a.keyCode)},b.normalize=function(a){var b,d,e,f=[],g=[];if(void 0===a||null===a)return a;if(a===h)return h;for(b=a.toLowerCase().split(h),d=0;d<b.length;d++)e=c(b[d]),void 0!==e?f[e]=b[d]:g.push(b[d]);return f=f.concat(g),f=f.filter(function(a){return a}),f.join(h)},g}(SC),SC.Manager=function(a,b){"use strict";function c(b){this.context=a.scdefault,this.isStatic=b||!1}function d(a){g&&console.debug(a)}var e=new a.Store,f=new a.Normalizer,g=!1;return a.scdefault=window,b=c.prototype,b.create=function(b){return(new a.Manager)["in"](b)},b["in"]=function(a){if(this.isStatic)throw"ShortcutManager: Can not change context on static method. Use ShortcutManager.create() with right context.";return this.context=a,this},b.on=function(a,b,c){var g=f.normalize(a);e.save(g,this.context,b,c),d("register "+a)},b.normalize=function(a){return"object"==typeof a?f.fromEvent(a):f.normalize(a)},b.remove=function(a,b){e.remove(this.context,f.normalize(a),b)},b.event=function(a){var b,c,g,h=f.fromEvent(a);if(h)if(b=e.get(h),b&&b.length){for(d("ShortcutManage: Trying to handle '"+h+"' shortcut,","available handlers:"),g=b.length-1;g>=0;g--){if(c=b[g]())return d("ShortcutManage: Handler with index '"+g+"' handled shortcut, handler: "),d(b[g]),!0;d("ShortcutManage: Handler with index '"+g+"' returned false...trying next")}d("ShortcutManage: There is no more handler to try, returning false")}else d("ShortcutManage: There is no handler for '"+h+"' shortcut");return!1},b.exists=function(a){return"object"==typeof a&&(a=f.fromEvent(a)),e.exists(a)},b.destroy=function(){this.remove()},b.debugMode=function(a){g=a,console.info("ShortcutManager debug mode is set to "+(a?"on":"off"))},c}(SC);var ShortcutManager=new SC.Manager(!0);